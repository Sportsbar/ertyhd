//using System;
//using System.IdentityModel.Tokens.Jwt;
//using System.Security.Claims;
//using Microsoft.IdentityModel.Tokens;

//namespace Derty.API.Helpers
//{
//    public class JwtTokenGenerator
//    {
//        private readonly SymmetricSecurityKey _key;
//        private readonly string _issuer;
//        private readonly string _audience;
//        private readonly int _tokenExpirationInMinutes;

//        public JwtTokenGenerator(string secretKey, string issuer, string audience, int tokenExpirationInMinutes)
//        {
//            _key = new SymmetricSecurityKey(Convert.FromBase64String(secretKey));
//            _issuer = issuer;
//            _audience = audience;
//            _tokenExpirationInMinutes = tokenExpirationInMinutes;
//        }

//        public string GenerateJwtToken(ClaimsIdentity identity)
//        {
//            var tokenHandler = new JwtSecurityTokenHandler();
//            var tokenDescriptor = new SecurityTokenDescriptor
//            {
//                Subject = identity,
//                Expires = DateTime.UtcNow.AddMinutes(_tokenExpirationInMinutes),
//                Issuer = _issuer,
//                Audience = _audience,
//                SigningCredentials = new SigningCredentials(_key, SecurityAlgorithms.HmacSha256Signature)
//            };
//            var token = tokenHandler.CreateToken(tokenDescriptor);

//            return tokenHandler.WriteToken(token);
//        }
//    }
//}
